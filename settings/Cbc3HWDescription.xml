<?xml version='1.0' encoding='utf-8'?>
<HwDescription>
  <BeBoard Id="0" boardType="CBC3FC7">
    <connection id="board" uri="chtcp-2.0://cmsuptracker008.cern.ch:10203?target=192.168.0.80:50001" address_table="file://settings/cbc3_system_address_table.xml" />

    <Module FeId="0" FMCId="1" ModuleId="0" Status="1">
        <!--<Global>-->
            <!--<Settings threshold="580" latency="200"/>-->
            <!--<TestPulse enable="1" polarity="0" amplitude="0x08" channelgroup="0" delay="0" groundothers="1"/>-->
            <!--<ClusterStub clusterwidth="4" ptwidth="3" layerswap="0" off1="0" off2="0" off3="0" off4="0"/>-->
            <!--<Misc analogmux="0b00000" pipelogic="1" stublogic="1" or254="0" tpgclock="1" dll="4"/>-->
            <!--<ChannelMask disable="1"/>-->
        <!--</Global>-->
        <!--<Global_CBC_Register name="TriggerLatency1"> 0x09 </Global_CBC_Register>-->
        <CBC_Files path="./settings/" />
        <!--<CBC Id="0" configfile="CBC3_default.txt" />-->
        <!--experimental-->
        <CBC Id="0" configfile="CBC3_default.txt" >
            <Settings threshold="500" latency="199"/>
            <TestPulse enable="0" polarity="0" amplitude="0x08" channelgroup="0" delay="0" groundothers="1"/>
            <ClusterStub clusterwidth="4" ptwidth="3" layerswap="0" off1="0" off2="0" off3="0" off4="0"/>
            <Misc analogmux="0b00000" pipelogic="1" stublogic="1" or254="0" tpgclock="1" dll="4"/>
            <ChannelMask disable=""/>
        </CBC>
    </Module>

    <!--TRIGGER-->
    <Register name="cbc_system_cnfg">
        <!--CLOCKING - 0x0 EXTERNAL / 0x1 INTERNAL-->
        <!--required-->
        <Register name="global.misc.cbc_clk_phase_shift"> 0x1 </Register>
        <!--to output trigger-->
        <Register name="global.test_out.1"> 0x0020 </Register>
        <Register name="global.test_out.2"> 0x0001 </Register>
        <Register name="cbc_system_clk"> 0x1 </Register>
        <!--FAST SIGNAL SOURCE-->
        <Register name="fast_command_manager">
            <Register name="fast_signal_enable">
                <Register name="async_l1a"> 0x0 </Register>
                <Register name="fmc"> 0x0 </Register>
                <!--required-->
                <Register name="ipbus"> 0x1 </Register>
                <Register name="internal"> 0x1 </Register>
            </Register>
            <!--FAST SIGNAL GENERATOR CONFIG-->
            <Register name="fast_signal_generator">
                <!--Kirkia sets this node to 7, so enables everything but fast_reset-->
                <Register name="enable">
                    <Register name="fast_reset"> 0 </Register>
                    <Register name="trigger"> 1 </Register>
                    <Register name="test_pulse"> 0 </Register>
                    <Register name="orbit_reset"> 0 </Register>
                </Register>
                <!--FAST SIGNAL GENERATOR TIMING-->
                <Register name="Ncycle"> 0 </Register>
                <Register name="cycle_period"> 80 </Register>
                <Register name="trigger_timing"> 19 </Register>
                <Register name="test_pulse_timing"> 2 </Register>
                <Register name="orbit_reset_timing"> 100 </Register>
            </Register>
        </Register>
        <!--LATENCIES-->
        <Register name="cbc_data_processor">
            <Register name="cbc0.latencies">
                <Register name="l1a"> 199 </Register>
                <Register name="trig_data"> 196 </Register>
            </Register>
        </Register>
    </Register>
  </BeBoard>
</HwDescription>

<Settings>
    <Setting name="TargetVcth">595</Setting>
    <Setting name="TargetOffset">0x50</Setting>
    <!--<Setting name="TestPulsePotentiometer">0x00</Setting>-->
    <Setting name="HoleMode">0</Setting>
    <Setting name="VerificationLoop">1</Setting>
    <!--PulseShape-->
    <Setting name="Nevents" > 100 </Setting>
    <!--<Setting name="Vplus" > 0x50 </Setting>-->
    <!--<Setting name="TPAmplitude" > 0x0C </Setting>-->
    <!--<Setting name="TestGroup" > 1 </Setting>-->
    <!--<Setting name="ChannelOffset" > 0x40 </Setting>-->
    <!--<Setting name="StepSize" > 15 </Setting>-->
    <Setting name="FitSCurves" > 0 </Setting>
</Settings>
